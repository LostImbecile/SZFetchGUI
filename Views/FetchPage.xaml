<Page
    x:Class="SZExtractorGUI.Views.FetchPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="clr-namespace:SZExtractorGUI.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:SZExtractorGUI.Views"
    xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewModels="clr-namespace:SZExtractorGUI.ViewModels"
    Title="FetchPage"
    d:DesignHeight="480"
    d:DesignWidth="1065.5"
    mc:Ignorable="d">

    <Page.Resources>
        <ResourceDictionary>
            <converters:BooleanToSymbolConverter x:Key="BooleanToSymbolConverter" />
            <converters:BoolToColorConverter x:Key="BoolToColorConverter" />
            <converters:InverseBoolToVisibilityConverter x:Key="InverseBoolToVisibilityConverter" />
            <converters:StringToVisibilityConverter x:Key="StringToVisibilityConverter" />
            <converters:EnumBooleanConverter x:Key="EnumBooleanConverter" />
        </ResourceDictionary>
    </Page.Resources>

    <Grid Margin="0,0,5,0">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2.5*" />
            <ColumnDefinition Width="*" MaxWidth="250" />
        </Grid.ColumnDefinitions>

        <!--  Main Content  -->
        <Grid Grid.Column="0" Margin="5">
            <Grid.RowDefinitions>
                <!--  Row 0: Filters  -->
                <RowDefinition Height="Auto" />
                <!--  Row 1: Language  -->
                <RowDefinition Height="Auto" />
                <!--  Row 2: Grid Header  -->
                <RowDefinition Height="Auto" />
                <!--  Row 3: Grid Content  -->
                <RowDefinition Height="*" />
                <!--  Row 4: Note  -->
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <!--  Content Type Dropdown - Row 0  -->


            <!--  Search & Filters - Row 0  -->
            <StackPanel Grid.Row="0" Orientation="Horizontal">
                <ComboBox
                    Grid.Row="0"
                    Width="200"
                    Margin="0,0,10,10"
                    HorizontalAlignment="Left"
                    BorderBrush="{DynamicResource MahApps.Brushes.ThemeForeground}"
                    DisplayMemberPath="Name"
                    ItemsSource="{Binding ContentTypes}"
                    SelectedItem="{Binding SelectedContentType}" />

                <TextBox
                    Width="200"
                    Margin="0,0,10,10"
                    VerticalAlignment="Center"
                    mah:TextBoxHelper.ClearTextButton="True"
                    mah:TextBoxHelper.Watermark="Search items..."
                    Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" />

                <TextBlock
                    Margin="0,0,5,10"
                    VerticalAlignment="Center"
                    Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                    Text="Voice Language:" />
                <RadioButton
                    Margin="0,0,5,10"
                    Background="{x:Null}"
                    Content="All"
                    IsChecked="{Binding SelectedLanguage, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=All}" />
                <RadioButton
                    Margin="0,0,5,10"
                    Background="{x:Null}"
                    Content="JP"
                    IsChecked="{Binding SelectedLanguage, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=Japanese}" />
                <RadioButton
                    Margin="0,0,5,10"
                    Background="{x:Null}"
                    Content="ENG"
                    IsChecked="{Binding SelectedLanguage, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=English}" />


            </StackPanel>

            <!--  Language Controls - Row 1  -->
            <StackPanel
                Grid.Row="1"
                Margin="0,0,0,10"
                Orientation="Horizontal">
                <TextBlock
                    Margin="0,0,5,2"
                    VerticalAlignment="Center"
                    Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                    Text="Locres Language:" />
                <ComboBox
                    Width="100"
                    Margin="5,0,10,0"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    DisplayMemberPath="DisplayName"
                    ItemsSource="{Binding AvailableLanguages}"
                    SelectedItem="{Binding SelectedTextLanguageItem, UpdateSourceTrigger=PropertyChanged}"
                    ToolTip="Text Language Filter" />
                <StackPanel Margin="0,0,10,0" Orientation="Horizontal">
                    <CheckBox
                        Margin="0,0,10,0"
                        VerticalAlignment="Center"
                        Content="Show Mods Only"
                        IsChecked="{Binding ShowModsOnly}" />
                    <CheckBox
                        VerticalAlignment="Center"
                        Content="Show Game Files Only"
                        IsChecked="{Binding ShowGameFilesOnly}" />
                </StackPanel>

            </StackPanel>

            <!--  Grid Header - Row 2  -->
            <Grid Grid.Row="2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="80" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <TextBlock
                    Grid.Column="0"
                    Margin="0,0,0,5"
                    FontWeight="Bold"
                    Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                    Text="Game Items" />
                <mah:ProgressRing
                    Grid.Column="1"
                    Width="20"
                    Height="20"
                    Margin="10,0,0,2"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Foreground="{DynamicResource MahApps.Brushes.Accent}"
                    Visibility="{Binding IsOperationInProgress, Converter={StaticResource BooleanToVisibilityConverter}}" />
            </Grid>

            <!--  Grid Content - Row 3  -->
            <local:CustomDataGrid
                x:Name="RemoteItemsGrid"
                Grid.Row="3"
                AutoGenerateColumns="False"
                CanUserAddRows="False"
                CanUserDeleteRows="False"
                DisableDoubleClick="True"
                ExcludeSelectColumn="True"
                HideSelectionHighlight="True"
                IsSelectedPropertyName="IsSelected"
                ItemsSource="{Binding RemoteItems}"
                SelectedItem="{Binding SelectedRemoteItem, Mode=TwoWay}"
                SelectedItemsList="{Binding SelectedItems}"
                SelectionMode="Extended"
                SelectionUnit="FullRow">
                <DataGrid.Columns>
                    <DataGridTemplateColumn Width="80" Header="Select">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <CheckBox HorizontalAlignment="Center" IsChecked="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTextColumn
                        Width="1.5*"
                        Binding="{Binding CharacterName}"
                        ElementStyle="{StaticResource LeftAlignedDataGridTextBlockStyle}"
                        Header="Name"
                        IsReadOnly="True" />
                    <DataGridTextColumn
                        Width="*"
                        Binding="{Binding Type}"
                        ElementStyle="{StaticResource LeftAlignedDataGridTextBlockStyle}"
                        Header="Type"
                        IsReadOnly="True" />
                    <DataGridTextColumn
                        Width="*"
                        Binding="{Binding CharacterId}"
                        ElementStyle="{StaticResource CenterAlignedDataGridTextBlockStyle}"
                        Header="ID"
                        IsReadOnly="True" />
                    <DataGridTextColumn
                        Width="*"
                        Binding="{Binding Container}"
                        ElementStyle="{StaticResource CenterAlignedDataGridTextBlockStyle}"
                        Header="Container"
                        IsReadOnly="True" />
                    <DataGridTextColumn
                        Width="60"
                        Binding="{Binding IsMod, Converter={StaticResource BooleanToSymbolConverter}}"
                        ElementStyle="{StaticResource CenterAlignedDataGridTextBlockStyle}"
                        Header="Mod"
                        IsReadOnly="True" />
                </DataGrid.Columns>
            </local:CustomDataGrid>

            <TextBlock
                Grid.Row="4"
                Margin="5,5,0,0"
                VerticalAlignment="Center"
                FontSize="10"
                Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                Text="Note: You may use keyboard shortcuts to select/delete multiple items in either list." />

        </Grid>

        <!--  Right Panel with ListView  -->
        <Grid Grid.Column="1" Margin="5,0,5,10">
            <Border BorderBrush="{DynamicResource MahApps.Brushes.Button.Border}" BorderThickness="1.5">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <TextBlock
                        Grid.Row="0"
                        Margin="10"
                        FontSize="14"
                        Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                        Text="Selected Items"
                        TextAlignment="Center" />
                    <ListView
                        x:Name="SelectedItemsListView"
                        Grid.Row="1"
                        Grid.Column="1"
                        Margin="10,0,10,10"
                        ItemsSource="{Binding SelectedItems}"
                        KeyDown="SelectedItemsListView_KeyDown"
                        SelectionMode="Extended">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding DisplayName}" />
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>

                    <!--  Buttons Panel  -->
                    <StackPanel
                        Grid.Row="2"
                        Margin="10,0,10,10"
                        Orientation="Vertical">
                        <StackPanel
                            Margin="0,0,0,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Orientation="Horizontal">
                            <TextBlock
                                Margin="0,0,10,0"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}"
                                Text="Name Language:" />
                            <ComboBox
                                Width="100"
                                Height="20"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                DisplayMemberPath="DisplayName"
                                ItemsSource="{Binding AvailableLanguages}"
                                SelectedItem="{Binding SelectedDisplayLanguageItem, UpdateSourceTrigger=PropertyChanged}"
                                ToolTip="Display Language" />
                        </StackPanel>
                        <Button
                            Margin="5"
                            Command="{Binding FetchFilesCommand}"
                            Content="Fetch Files"
                            Style="{StaticResource MahApps.Styles.Button}" />
                        <Button
                            Margin="5"
                            Command="{Binding RefreshCommand}"
                            Content="Refresh"
                            Style="{StaticResource MahApps.Styles.Button}" />
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Page>
